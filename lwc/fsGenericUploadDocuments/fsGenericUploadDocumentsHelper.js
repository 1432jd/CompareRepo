export function setDeferralPicklistValue(stageName) {
    var deferalPicklistOption = [];
    if (stageName === 'Login') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'FIV - B', value: 'FIV - B' },
            { label: 'FIV - C', value: 'FIV - C' },
            { label: 'Online EC', value: 'Online EC' },
            { label: 'Lead Detail', value: 'Lead Detail' },
            { label: 'In Principle Sanction', value: 'In Principle Sanction' },
            { label: 'Process Credit', value: 'Process Credit' },
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'FIV - B') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'FIV - C', value: 'FIV - C' },
            { label: 'Online EC', value: 'Online EC' },
            { label: 'Lead Detail', value: 'Lead Detail' },
            { label: 'In Principle Sanction', value: 'In Principle Sanction' },
            { label: 'Process Credit', value: 'Process Credit' },
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'FIV - C') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Online EC', value: 'Online EC' },
            { label: 'Lead Detail', value: 'Lead Detail' },
            { label: 'In Principle Sanction', value: 'In Principle Sanction' },
            { label: 'Process Credit', value: 'Process Credit' },
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Online EC') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Lead Detail', value: 'Lead Detail' },
            { label: 'In Principle Sanction', value: 'In Principle Sanction' },
            { label: 'Process Credit', value: 'Process Credit' },
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'In Principle Sanction') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Lead Detail', value: 'Lead Detail' },
            { label: 'Process Credit', value: 'Process Credit' },
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Lead Detail') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Process Credit', value: 'Process Credit' },
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }

    if (stageName === 'Legal Opinion') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Legal Approval', value: 'Legal Approval' },
            { label: 'Process Credit', value: 'Process Credit' },
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Legal Approval') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Process Credit', value: 'Process Credit' },
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Process Credit') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Approval Credit', value: 'Approval Credit' },
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Approval Credit') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Final Sanction', value: 'Final Sanction' },
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Final Sanction') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Post Approval', value: 'Post Approval' },
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Post Approval') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'MOD Registration', value: 'MOD Registration' },
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'MOD Registration') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Agreement Execution', value: 'Agreement Execution' },
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Agreement Execution') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Dispatch Pending', value: 'Dispatch Pending' },
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Dispatch Pending') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Document Receipt', value: 'Document Receipt' },
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Document Receipt') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Disbursal Maker', value: 'Disbursal Maker' },
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Disbursal Maker') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Disbursal Author', value: 'Disbursal Author' },
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Disbursal Author') {
        var option = [
            {label : stageName, value: stageName},
            { label: 'Document Deferral', value: 'Document Deferral' },
        ]
        deferalPicklistOption = option;
    }
    if (stageName === 'Document Deferral') {
        var option = [
            {label : stageName, value: stageName},
        ]
        deferalPicklistOption = option;
    }
    return deferalPicklistOption;
}

export function handleUploadPhotos(event, applicationId, stageName) {
    var additionalUploadPhotos = [];
    if (event.target.files.length > 0) {
        for (var i = 0; i < event.target.files.length; i++) {
            if (Math.round((event.target.files[i].size / 1024)) <= 4403) {
                let file = event.target.files[i];
                let reader = new FileReader();
                reader.onload = e => {
                    var fileContents = reader.result.split(',')[1]
                    additionalUploadPhotos.push({ 'fileName': file.name, 'base64': fileContents, 'recordId': applicationId, 'stagName': stageName });
                };
                reader.readAsDataURL(file);
            }
        }
    }
    return additionalUploadPhotos;
}

export function documentMasterOption(documentMasters, value, documentMasterIds) {
    console.log('Master Function Called');
    console.log('documentMasters #####', documentMasters);
    console.log('value');
    var documentMasterOptions = [];
    documentMasters.forEach(element => {
        if (!documentMasterIds.includes(element.Id) && element.Type__c === value && (value != 'All' || value != 'Mandatory')) {
            documentMasterOptions.push({ label: element.Description__c, value: element.Id + '-' + element.Name });
        }
        else if (!documentMasterIds.includes(element.Id) && (value === 'Mandatory' || value === 'All')) {
            documentMasterOptions.push({ label: element.Description__c, value: element.Id + '-' + element.Name });
        }
    });
    console.log(':: documentMasterOptions IN Helper :: ', JSON.stringify(documentMasterOptions));
    return documentMasterOptions;
}

export function assignStatusField(documentData, statusPicklistOptions, stageName) {
    console.log('ASSIGN STATUS FIELD ', stageName);
    let tempDocData = JSON.parse(JSON.stringify(documentData));
    tempDocData.forEach(currentItem => {
        let tempArr = JSON.parse(JSON.stringify(statusPicklistOptions));
        let options = [];
        tempArr.forEach(opt => {
            if (currentItem.status === 'Waived' || (stageName === 'Document Deferral' && opt.value === 'Waived')) {
                if (opt.value == currentItem.status) {
                    opt.isSelected = true;
                } else {
                    opt.isSelected = false;
                }
                options.push(opt);
            }
            if (currentItem.status != 'Waived' && opt.value != 'Waived') {
                if (opt.value == currentItem.status) {
                    opt.isSelected = true;
                } else {
                    opt.isSelected = false;
                }
                options.push(opt);
            }
        });
        currentItem.selectOptions = JSON.parse(JSON.stringify(options));
    });
    return tempDocData;
}

export function currentStageDocuments(stageName, allDocuments) {
    var documentsData = [];
    var count = 1
    var documents = JSON.parse(JSON.stringify(allDocuments));
    documents.forEach(element => {
        if (element.docReceivedStage === stageName || element.deferredFrom === stageName || (element.status === 'Deferred' && element.stage == stageName)) {
            element.localSerialNumber = count
            documentsData.push(element);
            count++;
        }
    });
    console.log('DocumentData ', JSON.stringify(documentsData));
    return documentsData;
}

export function stringToDate(_date, _format, _currentdelimiter, _targetDelimiter) {
    const numberSet = new Set([1, 2, 3, 4, 5, 6, 7, 8, 9]);
    var formatLowerCase = _format.toLowerCase();
    var formatItems = formatLowerCase.split(_targetDelimiter);
    var dateItems = _date.split(_currentdelimiter);
    var monthIndex = formatItems.indexOf("mm");
    var dayIndex = formatItems.indexOf("dd");
    var yearIndex = formatItems.indexOf("yyyy");
    var month = parseInt(dateItems[monthIndex]);
    month = numberSet.has(month) ? '0' + month : month;
    console.log('MONTH NUNBER', month);
    // month -= 1;
    // var formatedDate = (dateItems[yearIndex], month, dateItems[dayIndex]);
    var formatedDate = (dateItems[yearIndex] + '-' + month + '-' + dateItems[dayIndex]);
    console.log('AFTER CONVERTED BUSINESS DATE ', formatedDate);
    return formatedDate;
}

export function removeDuplicate(jsonData) {
    var documentSetCodeIds = [];
    var documents = JSON.parse(JSON.stringify(jsonData));
    var docData = [];
    documents.forEach(element => {
        var key;
        if(element.documentType === 'Asset'){
            key = element.docSetCodeId+'-'+element.propertyId;
        }
        if(element.documentType === 'Applicant'){
            key = element.docSetCodeId+'-'+element.applicantId;
        }
        if(element.documentType === 'Application'){
            key = element.docSetCodeId;
        }
        if (element.docSetCodeId && !documentSetCodeIds.includes(key)) {
            documentSetCodeIds.push(key);
            docData.push(element);
        }
    });
    return docData;
}

export function newRowDocumentRecord(currentDocumentType, businessDate, isAgreementExecution) {
    var newRowDocumentRecord = {
        'docSetCodeId': '',
        'serialNumber': '',
        'documentName': '',
        'documentFamily': '',
        'documentType': currentDocumentType,
        'documentCode': '',
        'mandatory': '',
        'status': 'Not Received',
        'isStatusDisabled': false,
        'stage': '',
        'deferredStageDisable': false,
        'deferredRequired': true,
        'deferredDate': '',
        'receivedDate': '',
        'isReceivedDateRequired': false,
        'receivedDateDisable': true,
        'noOfPages': '',
        'waiverReason': '',
        'fileData': null,
        'isWaiverRequired': false,
        'waiverReasonDisable': true,
        'original': '',
        'isoriginalDisabled': true,
        'remarks': '',
        'applicableFor': '',
        'isNewRowAdded': false,
        'isDocumentMaster': false,
        'fileName': '',
        'isAgreementExecution': isAgreementExecution,
        'documentCondition': '',
        'agreementDocumentType': '',
        'isFileUploadDisabled': true,
        'isFileUploadRequired': false,
        'isDeferalRecord': false,
        'deferalRecordId': '',
        'contentDocumentId': '',
        'isDeferredDateRequired': false,
        'isDeferred': true,
    }
    return newRowDocumentRecord;
}

export function setAllRecordData(listOfDeferralMasterDocumentDocument, stageName, isAgreementExecution, mapOfDeferralDocument, mapOfContentVersion, listOfDocumentSetCode, applicationId, listOfLoanApplicant, listOfEmpoymentDetails, listOfProperty) {
    var applicationJSON = [];
    var applicantJSON = [];
    var propertyJSON = [];
    var documentMasterIds = [];

    var dataObject = {
        applicationJSON: null,
        applicantJSON: null,
        propertyJSON: null,
        documentMasterIds: null
    };

    console.log('listOfDeferralMasterDocumentDocument ', JSON.stringify(listOfDeferralMasterDocumentDocument));

    listOfDeferralMasterDocumentDocument.forEach(element => {
        if (element.Deferral_Stage__c === stageName && element.Is_Document_Master_Record__c && !element.Is_Document_Received__c && element.Type__c === 'Asset') {
            console.log('inside deferal master record first', element.isDeferred__c);
            var newRow = {
                'documentCode': element.Document_Name__c,
                'docSetCodeId': element.Document_Set_Code__c,
                'applicationId': '',
                'serialNumber': '',
                'deferredFrom' : element.Deferred_From__c,
                'documentName': element.Document_Name__c,
                'documentFamily': element.Document_Family__c,
                'mandatory': element.Mandatory__c,
                'documentType': element.Type__c,
                'applicableName': element.Applicable_Name__c,
                'status': element.Is_Document_Received__c ? 'Received' : element.Status__c,
                'stage': element.Deferral_Stage__c,
                'isStatusDisabled': element.Is_Document_Received__c ? true : element.Deferred_From__c === stageName ? true : element.Deferral_Stage__c === stageName && element.Status__c === 'Waived' ? true : false,
                'deferredStageDisable': true,
                'deferredRequired': false,
                'deferredDate': element.Deferral_Date__c,
                'receivedDate': '',
                'isReceivedDateRequired': false,
                'receivedDateDisable': true,
                'docReceivedStage': element.Deferral_Stage__c,
                'noOfPages': '',
                'waiverReason': element.Waiver_Reason__c,
                'isWaiverRequired': false,
                'waiverReasonDisable': true,
                'remarks': element.Remarks__c,
                'isNewRowAdded': false,
                'fileName': '',
                'isFileUploadDisabled': true,
                'isFileUploadRequired': true,
                'original': '',
                'isoriginalDisabled': true,
                'fileData': '',
                'isAgreementExecution': isAgreementExecution,
                'isDeferalRecord': true,
                'deferalRecordId': element.Id,
                'isDocumentMaster': true,
                'applicantId': element.Type__c === 'Applicant' ? element.Current_Record_Id__c : '',
                'propertyId': element.Type__c === 'Asset' ? element.Current_Record_Id__c : '',
                'parentPropertyId': element.Parent_Property_Id__c ? element.Parent_Property_Id__c : '',
                'applicableFor': element.Type__c === 'Applicant' ? element.Applicable_For__c : '',
                'customerName': element.Type__c === 'Applicant' ? element.Applicant_Name__c : '',
                'customerType': element.Type__c === 'Applicant' ? element.Applicant_Type__c : '',
            }
            console.log('Console Log 111111111', newRow);
            if (!element.isDeferred__c) {
                newRow.status = 'Not Received';
                newRow.deferredDate = null;
                newRow.isStatusDisabled = false
                newRow.docReceivedStage = newRow.stage;
            }
            if (element.Type__c === 'Application') {
                applicationJSON.push(newRow)
            }
            if (element.Type__c === 'Applicant') {
                applicantJSON.push(newRow)
            }
            if (element.Type__c === 'Asset') {
                propertyJSON.push(newRow)
            }
        }
        if (element.Deferred_From__c === stageName) {
            console.log('inside deferal master record second', element);
            var newRow = {
                'documentCode': element.Document_Name__c,
                'docSetCodeId': element.Document_Set_Code__c,
                'applicationId': '',
                'serialNumber': '',
                'deferredFrom' : element.Deferred_From__c,
                'documentName': element.Document_Name__c,
                'documentFamily': element.Document_Family__c,
                'mandatory': element.Mandatory__c,
                'documentType': element.Type__c,
                'applicableName': element.Applicable_Name__c,
                'status': element.Status__c === 'Deferred' ? 'Deferred' : element.Deferred_From__c === element.Uploaded_From__c && element.Status__c === 'Waived' ? 'Waived' : element.Deferred_From__c !== element.Uploaded_From__c && element.Status__c === 'Waived' ? 'Deferred' : '',
                'stage': element.Deferral_Stage__c,
                'isStatusDisabled': element.Is_Document_Received__c ? true : element.Deferred_From__c === stageName ? true : element.Deferral_Stage__c === stageName && element.Status__c === 'Waived' ? true : false,
                'deferredStageDisable': true,
                'deferredRequired': false,
                'deferredDate': element.Deferral_Date__c,
                'receivedDate': '',
                'isReceivedDateRequired': false,
                'docReceivedStage': element.Deferral_Stage__c,
                'receivedDateDisable': true,
                'noOfPages': '',
                'waiverReason': element.Waiver_Reason__c,
                'isWaiverRequired': false,
                'waiverReasonDisable': true,
                'remarks': element.Remarks__c,
                'isNewRowAdded': false,
                'fileName': '',
                'isFileUploadDisabled': true,
                'isFileUploadRequired': true,
                'original': '',
                'isoriginalDisabled': true,
                'fileData': '',
                'isAgreementExecution': isAgreementExecution,
                'isDeferalRecord': true,
                'deferalRecordId': element.Id,
                'isDocumentMaster': true,
                'applicantId': element.Type__c === 'Applicant' ? element.Current_Record_Id__c : '',
                'propertyId': element.Type__c === 'Asset' ? element.Current_Record_Id__c : '',
                'parentPropertyId': element.Parent_Property_Id__c ? element.Parent_Property_Id__c : '',
                'applicableFor': element.Type__c === 'Applicant' ? element.Applicable_For__c : '',
                'customerName': element.Type__c === 'Applicant' ? element.Applicant_Name__c : '',
                'customerType': element.Type__c === 'Applicant' ? element.Applicant_Type__c : '',
            }
            console.log('Console Log 222222', JSON.stringify(newRow));
            if (!element.isDeferred__c) {
                newRow.status = 'Not Received';
                newRow.deferredDate = null;
                newRow.isStatusDisabled = false
                newRow.docReceivedStage = newRow.stage;
            }
            if (element.Type__c === 'Application') {
                applicationJSON.push(newRow)
            }
            if (element.Type__c === 'Applicant') {
                applicantJSON.push(newRow)
            }
            if (element.Type__c === 'Asset') {
                propertyJSON.push(newRow)
            }
        }
        if (element.Deferral_Stage__c === stageName && !element.Is_Document_Received__c) {
            console.log('inside deferal master record third', element);
            var newRow = {
                'documentCode': element.Document_Name__c,
                'docSetCodeId': element.Document_Set_Code__c,
                'applicationId': '',
                'serialNumber': '',
                'deferredFrom' : element.Deferred_From__c,
                'documentName': element.Document_Name__c,
                'documentFamily': element.Document_Family__c,
                'mandatory': element.Mandatory__c,
                'docReceivedStage': element.Deferral_Stage__c,
                'documentType': element.Type__c,
                'applicableName': element.Applicable_Name__c,
                'status': element.Is_Document_Received__c ? 'Received' : element.Status__c,
                'stage': element.Deferral_Stage__c,
                'isStatusDisabled': element.Is_Document_Received__c ? true : element.Deferred_From__c === stageName ? true : element.Deferral_Stage__c === stageName && element.Status__c === 'Waived' ? true : false,
                'deferredStageDisable': true,
                'deferredRequired': false,
                'deferredDate': element.Deferral_Date__c,
                'receivedDate': '',
                'isReceivedDateRequired': false,
                'receivedDateDisable': true,
                'noOfPages': '',
                'waiverReason': element.Waiver_Reason__c,
                'isWaiverRequired': false,
                'waiverReasonDisable': true,
                'remarks': element.Remarks__c,
                'isNewRowAdded': false,
                'fileName': '',
                'isFileUploadDisabled': true,
                'isFileUploadRequired': true,
                'original': '',
                'isoriginalDisabled': true,
                'fileData': '',
                'isAgreementExecution': isAgreementExecution,
                'isDeferalRecord': true,
                'deferalRecordId': element.Id,
                'isDocumentMaster': true,
                'applicantId': element.Type__c === 'Applicant' ? element.Current_Record_Id__c : '',
                'propertyId': element.Type__c === 'Asset' ? element.Current_Record_Id__c : '',
                'applicableFor': element.Type__c === 'Applicant' ? element.Applicable_For__c : '',
                'customerName': element.Type__c === 'Applicant' ? element.Applicant_Name__c : '',
                'customerType': element.Type__c === 'Applicant' ? element.Applicant_Type__c : '',
            }
            console.log('Console Log 333333', JSON.stringify(newRow));
            if (!element.isDeferred__c) {
                newRow.status = 'Not Received';
                newRow.deferredDate = null;
                newRow.isStatusDisabled = false
                newRow.docReceivedStage = newRow.stage;
            }
            if (element.Type__c === 'Application') {
                applicationJSON.push(newRow)
            }
            if (element.Type__c === 'Applicant') {
                applicantJSON.push(newRow)
            }
            if (element.Type__c === 'Asset') {
                propertyJSON.push(newRow)
            }
        }
    });
    /** For Show All Current Stage Deferral Document Record */
    if (mapOfDeferralDocument) {
        var cvMap = mapOfDeferralDocument;
        for (var key in cvMap) {
            if ((cvMap[key].Deferral_Stage__c === stageName && !cvMap[key].Is_Document_Master_Record__c && !cvMap[key].Is_Document_Received__c) || !cvMap[key].isDeferred__c) {
                console.log('inside map of deferal document first');
                var newRow = {
                    'documentCode': cvMap[key].Document_Name__c,
                    'docSetCodeId': cvMap[key].Document_Set_Code_Id__c,
                    'applicationId': '',
                    'serialNumber': '',
                    'documentName': cvMap[key].Document_Name__c,
                    'documentFamily': cvMap[key].Document_Family__c,
                    'mandatory': cvMap[key].Mandatory__c,
                    'documentType': cvMap[key].Document_Type__c,
                    'applicableName': cvMap[key].Applicable_Name__c,
                    'isStatusDisabled': stageName === cvMap[key].Uploaded_From__c ? true : false,
                    'status': 'Received',
                    'stage': '',
                    'docReceivedStage': cvMap[key].Uploaded_From__c,
                    'deferredStageDisable': true,
                    'deferredRequired': false,
                    'deferredDate': '',
                    'receivedDate': cvMap[key].Received_Date__c,
                    'isReceivedDateRequired': false,
                    'receivedDateDisable': true,
                    'noOfPages': cvMap[key].Number_of_Pages__c,
                    'waiverReason': '',
                    'isWaiverRequired': false,
                    'waiverReasonDisable': true,
                    'remarks': cvMap[key].Remarks__c,
                    'isNewRowAdded': false,
                    'fileName': '',
                    'isFileUploadDisabled': true,
                    'isFileUploadRequired': true,
                    'original': cvMap[key].Original__c,
                    'isoriginalDisabled': true,
                    'fileData': '',
                    'isAgreementExecution': isAgreementExecution,
                    'isDeferalRecord': false,
                    'deferalRecordId': '',
                    'isDocumentMaster': true,
                    'contentDocumentId': cvMap[key].ContentDocumentId,
                    'applicantId': cvMap[key].Document_Type__c === 'Applicant' ? cvMap[key].Current_Record_Id__c : '',
                    'propertyId': cvMap[key].Document_Type__c === 'Asset' ? cvMap[key].Current_Record_Id__c : '',
                }
                if (!cvMap[key].isDeferred__c) {
                    newRow.status = 'Not Received';
                    newRow.deferredDate = null;
                }
                if (cvMap[key].Type__c === 'Application') {
                    applicationJSON.push(newRow)
                }
                if (cvMap[key].Type__c === 'Applicant') {
                    applicantJSON.push(newRow)
                }
                if (cvMap[key].Type__c === 'Asset') {
                    propertyJSON.push(newRow)
                }
            }
        }
    }
    /** For Show All Content Version Record */
    if (mapOfContentVersion) {
        console.log('mapOfContentVersion ', mapOfContentVersion);
        var cvMap = mapOfContentVersion;
        for (var key in cvMap) {
            if (cvMap[key].Current_Stage__c != stageName && cvMap[key].Uploaded_From__c === stageName || cvMap[key].Is_Document_Master_Record__c) {
                console.log('inside map of cv document first', cvMap[key].Document_Name__c, cvMap[key].Applicable_For__c);
                var newRow = {
                    'documentCode': cvMap[key].Document_Name__c,
                    'docSetCodeId': cvMap[key].Document_Set_Code_Id__c,
                    'applicationId': '',
                    'serialNumber': '',
                    'documentName': cvMap[key].Document_Name__c,
                    'versionNumber': cvMap[key].Version_Number__c,
                    'documentFamily': cvMap[key].Document_Family__c,
                    'mandatory': cvMap[key].Mandatory__c,
                    'documentType': cvMap[key].Document_Type__c,
                    'applicableName': cvMap[key].Applicable_For__c,
                    'isStatusDisabled': stageName === cvMap[key].Uploaded_From__c ? true : false,
                    'status': cvMap[key].Status__c,
                    'stage': '',
                    'docReceivedStage': cvMap[key].Uploaded_From__c,
                    'deferredStageDisable': true,
                    'deferredRequired': false,
                    'deferredDate': '',
                    'receivedDate': cvMap[key].Received_Date__c,
                    'isReceivedDateRequired': false,
                    'receivedDateDisable': true,
                    'noOfPages': cvMap[key].Number_of_Pages__c,
                    'waiverReason': '',
                    'isWaiverRequired': false,
                    'waiverReasonDisable': true,
                    'remarks': cvMap[key].Remarks__c,
                    'isNewRowAdded': false,
                    'fileName': '',
                    'isFileUploadDisabled': true,
                    'isFileUploadRequired': true,
                    'original': cvMap[key].Original__c,
                    'isoriginalDisabled': true,
                    'fileData': '',
                    'isAgreementExecution': isAgreementExecution,
                    'isDeferalRecord': false,
                    'deferalRecordId': '',
                    'isDocumentMaster': true,
                    'contentDocumentId': cvMap[key].ContentDocumentId,
                    'applicantId': cvMap[key].Document_Type__c === 'Applicant' ? cvMap[key].Current_Record_Id__c : '',
                    'propertyId': cvMap[key].Document_Type__c === 'Asset' ? cvMap[key].Current_Record_Id__c : '',
                }
                if (cvMap[key].Document_Type__c === 'Application') {
                    applicationJSON.push(newRow)
                }
                if (cvMap[key].Document_Type__c === 'Applicant') {
                    applicantJSON.push(newRow)
                }
                if (cvMap[key].Document_Type__c === 'Asset') {
                    propertyJSON.push(newRow)
                }
            }
        }
    }
    /** For Show All Document Set Code Record */
    listOfDocumentSetCode.forEach(element => {
        documentMasterIds.push(element.Document_Master__c);
        if (element.Type__c === 'Application') {
            var isCVRecordFound = false;
            var cvRecord;
            for (var key in mapOfContentVersion) {
                if (key === element.Id && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                    isCVRecordFound = true;
                    cvRecord = mapOfContentVersion[key];
                }
            }
            var isDefRecordFound = false;
            var defRecord;
            for (var key in mapOfDeferralDocument) {
                if (key === element.Id && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                    isDefRecordFound = true;
                    defRecord = mapOfDeferralDocument[key];
                    console.log('DEFERED RECORD FOUND APPLICATION', isDefRecordFound, defRecord);
                }
            }
            var newRowDocumentRecord = {
                'documentCode': element.Document_Master__r.Name,
                'docSetCodeId': element.Id,
                'applicationId': applicationId,
                'serialNumber': '',
                'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                'documentName': element.Name,
                'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                'documentFamily': element.Family__c,
                'mandatory': element.Mandatory__c,
                'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                'documentType': element.Type__c,
                'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false, //isDefRecordFound && defRecord !== undefined ? true : false,
                'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Deferral_Stage__c : '',
                'deferredStageDisable': true,
                'deferredRequired': false,
                'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '', //isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Date__c : '',
                'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                'isReceivedDateRequired': false,
                'receivedDateDisable': true,
                'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                'isWaiverRequired': false,
                'waiverReasonDisable': true,
                'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                'isNewRowAdded': false,
                'isDocumentMaster': false,
                'fileName': '',
                'isFileUploadDisabled': true,
                'isFileUploadRequired': true,
                'original': isCVRecordFound ? cvRecord.Original__c : '',
                'isoriginalDisabled': true,
                'fileData': '',
                'isAgreementExecution': isAgreementExecution,
                'isDeferalRecord': defRecord ? true : false,
                'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
            }
            if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                newRowDocumentRecord.status = cvRecord.Status__c;
                // newRowDocumentRecord.isFileUploadDisabled = false;
                // newRowDocumentRecord.isFileUploadRequired = false;
            }
            applicationJSON.push(newRowDocumentRecord);
        }
        /**
         * Set Applicant JSON
         */
        if (element.Type__c === 'Applicant') {
            if (element.Applicable_For__c === 'All' && element.Income_Type__c === 'All') {
                console.log('** Inside first case **');
                listOfLoanApplicant.forEach(loan => {
                    var isCVRecordFound = false;
                    var cvRecord;
                    var uniqueKey = element.Id + '-' + loan.Customer_Information__c;
                    for (var key in mapOfContentVersion) {
                        if (key === uniqueKey && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                            isCVRecordFound = true;
                            cvRecord = mapOfContentVersion[key];
                        }
                    }
                    //For Deferral Document
                    var isDefRecordFound = false;
                    var defRecord;
                    for (var key in mapOfDeferralDocument) {
                        if (key === uniqueKey && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                            isDefRecordFound = true;
                            defRecord = mapOfDeferralDocument[key];
                            console.log('DEFERED RECORD FOUND', uniqueKey);
                        }
                    }
                    var newRowDocumentRecord = {
                        'documentCode': element.Document_Master__r.Name,
                        'docSetCodeId': element.Id,
                        'serialNumber': '',
                        'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                        'documentName': element.Name,
                        'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                        'documentFamily': element.Family__c,
                        'applicableFor': element.Applicable_For__c,
                        'applicableName': loan.Customer_Information__r.Name,
                        'mandatory': element.Mandatory__c,
                        'documentType': element.Type__c,
                        'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                        'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                        'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                        'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                        'deferredStageDisable': true,
                        'deferredRequired': false,
                        'deferredDate': isDefRecordFound ? defRecord.Deferral_Date__c : '',
                        'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                        'isReceivedDateRequired': false,
                        'receivedDateDisable': true,
                        'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                        'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                        'isWaiverRequired': false,
                        'waiverReasonDisable': true,
                        'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                        'isNewRowAdded': false,
                        'isDocumentMaster': false,
                        'fileName': '',
                        'isFileUploadDisabled': true,
                        'isFileUploadRequired': true,
                        'original': isCVRecordFound ? cvRecord.Original__c : '',
                        'isoriginalDisabled': true,
                        'fileData': '',
                        'isAgreementExecution': isAgreementExecution,
                        'applicantId': loan.Customer_Information__c,
                        'customerType': loan.Customer_Type__c,
                        'customerName': loan.Applicant_Name__c,
                        'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                        'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                        'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                    }
                    if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                        newRowDocumentRecord.status = cvRecord.Status__c;
                        // newRowDocumentRecord.isFileUploadDisabled = false;
                        // newRowDocumentRecord.isFileUploadRequired = false;
                    }
                    applicantJSON.push(newRowDocumentRecord);
                });

            } else {
                if (element.Applicable_For__c === "All" && element.Income_Type__c !== "All" && !listOfEmpoymentDetails.length) {
                    console.log('** Inside second case ** ' + JSON.stringify(listOfLoanApplicant));
                    listOfLoanApplicant.forEach(loan => {
                        var isCVRecordFound = false;
                        var cvRecord;
                        var uniqueKey = element.Id + '-' + loan.Customer_Information__c;
                        for (var key in mapOfContentVersion) {
                            if (key === uniqueKey && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                                isCVRecordFound = true;
                                cvRecord = mapOfContentVersion[key];
                            }
                        }
                        //For Deferral Document
                        var isDefRecordFound = false;
                        var defRecord;
                        for (var key in mapOfDeferralDocument) {
                            if (key === uniqueKey && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                                isDefRecordFound = true;
                                defRecord = mapOfDeferralDocument[key];
                                console.log('DEFERED RECORD FOUND', defRecord.Document_Name__c);
                            }
                        }
                        var newRowDocumentRecord = {
                            'documentCode': element.Document_Master__r.Name,
                            'docSetCodeId': element.Id,
                            'serialNumber': '',
                            'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                            'documentName': element.Name,
                            'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                            'documentFamily': element.Family__c,
                            'applicableFor': element.Applicable_For__c,
                            'applicableName': loan.Customer_Information__r.Name,
                            'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                            'mandatory': element.Applicable_For__c === loan.Customer_Type__c ? 'Yes' : 'No',
                            'documentType': element.Type__c,
                            'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                            'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                            'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                            'deferredStageDisable': true,
                            'deferredRequired': false,
                            'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                            'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                            'isReceivedDateRequired': false,
                            'receivedDateDisable': true,
                            'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                            'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                            'isWaiverRequired': false,
                            'waiverReasonDisable': true,
                            'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                            'isNewRowAdded': false,
                            'isDocumentMaster': false,
                            'fileName': '',
                            'isFileUploadDisabled': true,
                            'isFileUploadRequired': true,
                            'original': isCVRecordFound ? cvRecord.Original__c : '',
                            'isoriginalDisabled': true,
                            'fileData': '',
                            'isAgreementExecution': isAgreementExecution,
                            'applicantId': loan.Customer_Information__c,
                            'customerType': loan.Customer_Type__c,
                            'customerName': loan.Applicant_Name__c,
                            'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                            'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                            'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                        }
                        if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                            newRowDocumentRecord.status = cvRecord.Status__c;
                            // newRowDocumentRecord.isFileUploadDisabled = false;
                            // newRowDocumentRecord.isFileUploadRequired = false;
                        }
                        applicantJSON.push(newRowDocumentRecord);
                    });

                }
                else if (element.Applicable_For__c !== "All" && element.Income_Type__c === "All" && !listOfEmpoymentDetails.length) {
                    console.log('** Inside third case ** ' + element.Name, element);
                    listOfLoanApplicant.forEach(loan => {
                        if (loan.Customer_Type__c === element.Applicable_For__c) {
                            var isCVRecordFound = false;
                            var cvRecord;
                            var uniqueKey = element.Id + '-' + loan.Customer_Information__c;
                            for (var key in mapOfContentVersion) {
                                if (key === uniqueKey && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                                    isCVRecordFound = true;
                                    cvRecord = mapOfContentVersion[key];
                                }
                            }
                            console.log('isCVRecordFound #### ', isCVRecordFound);
                            console.log('cvRecord #### ', cvRecord);
                            var isDefRecordFound = false;
                            var defRecord;
                            for (var key in mapOfDeferralDocument) {
                                if (key === uniqueKey && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                                    isDefRecordFound = true;
                                    defRecord = mapOfDeferralDocument[key];
                                }
                            }
                            console.log('isDefRecordFound #### ', isDefRecordFound);
                            console.log('defRecord #### ', defRecord);
                            var newRowDocumentRecord = {
                                'documentCode': element.Document_Master__r.Name,
                                'docSetCodeId': element.Id,
                                'serialNumber': '',
                                'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                                'documentName': element.Name,
                                'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                                'documentFamily': element.Family__c,
                                'applicableFor': element.Applicable_For__c,
                                'applicableName': loan.Customer_Information__r.Name,
                                'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                                'mandatory': element.Applicable_For__c === loan.Customer_Type__c ? 'Yes' : 'No',
                                'documentType': element.Type__c,
                                'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                                'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                                'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                                'deferredStageDisable': true,
                                'deferredRequired': false,
                                'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                                'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                                'isReceivedDateRequired': false,
                                'receivedDateDisable': true,
                                'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                                'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                                'isWaiverRequired': false,
                                'waiverReasonDisable': true,
                                'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                                'isNewRowAdded': false,
                                'isDocumentMaster': false,
                                'fileName': '',
                                'isFileUploadDisabled': true,
                                'isFileUploadRequired': true,
                                'original': isCVRecordFound ? cvRecord.Original__c : '',
                                'isoriginalDisabled': true,
                                'fileData': '',
                                'isAgreementExecution': isAgreementExecution,
                                'applicantId': loan.Customer_Information__c,
                                'customerType': loan.Customer_Type__c,
                                'customerName': loan.Applicant_Name__c,
                                'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                                'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                                'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                            }
                            if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                                newRowDocumentRecord.status = cvRecord.Status__c;
                                // newRowDocumentRecord.isFileUploadDisabled = false;
                                // newRowDocumentRecord.isFileUploadRequired = false;
                            }
                            applicantJSON.push(newRowDocumentRecord);
                        }
                    });
                }
                else if (element.Applicable_For__c !== "All" && element.Income_Type__c !== "All" && !listOfEmpoymentDetails.length) {
                    console.log('** Inside fourth case **');
                    listOfLoanApplicant.forEach(loan => {
                        var isCVRecordFound = false;
                        var cvRecord;
                        var uniqueKey = element.Id + '-' + loan.Customer_Information__c;
                        for (var key in mapOfContentVersion) {
                            if (key === uniqueKey && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                                isCVRecordFound = true;
                                cvRecord = mapOfContentVersion[key];
                            }
                        }
                        //For Deferral Document
                        var isDefRecordFound = false;
                        var defRecord;
                        for (var key in mapOfDeferralDocument) {
                            if (key === uniqueKey && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                                isDefRecordFound = true;
                                defRecord = mapOfDeferralDocument[key];
                                console.log('DEFERED RECORD FOUND', defRecord.Document_Name__c);
                            }
                        }
                        var newRowDocumentRecord = {
                            'documentCode': element.Document_Master__r.Name,
                            'docSetCodeId': element.Id,
                            'serialNumber': '',
                            'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                            'documentName': element.Name,
                            'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                            'documentFamily': element.Family__c,
                            'applicableFor': element.Applicable_For__c,
                            'applicableName': loan.Customer_Information__r.Name,
                            'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                            'mandatory': element.Mandatory__c,
                            'documentType': element.Type__c,
                            'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                            'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                            'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                            'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                            'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                            'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                            'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                            'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                            'original': isCVRecordFound ? cvRecord.Original__c : '',
                            'deferredStageDisable': true,
                            'deferredRequired': false,
                            'isReceivedDateRequired': false,
                            'receivedDateDisable': true,
                            'isWaiverRequired': false,
                            'waiverReasonDisable': true,
                            'isNewRowAdded': false,
                            'isDocumentMaster': false,
                            'fileName': '',
                            'isFileUploadDisabled': true,
                            'isFileUploadRequired': true,
                            'isoriginalDisabled': true,
                            'fileData': '',
                            'isAgreementExecution': isAgreementExecution,
                            'applicantId': loan.Customer_Information__c,
                            'customerType': loan.Customer_Type__c,
                            'customerName': loan.Applicant_Name__c,
                            'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                            'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                            'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                        }
                        if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                            newRowDocumentRecord.status = cvRecord.Status__c;
                            // newRowDocumentRecord.isFileUploadDisabled = false;
                            // newRowDocumentRecord.isFileUploadRequired = false;
                        }
                        applicantJSON.push(newRowDocumentRecord);
                    });
                }


                //
                else if (element.Applicable_For__c === "All" && element.Income_Type__c !== "All" && listOfEmpoymentDetails.length) {
                    console.log('** Inside five case **');
                    var loanApplicantIds = [];
                    listOfLoanApplicant.forEach(loan => {
                        var isCVRecordFound = false;
                        var cvRecord;
                        var uniqueKey = element.Id + '-' + loan.Customer_Information__c;
                        for (var key in mapOfContentVersion) {
                            if (key === uniqueKey && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                                isCVRecordFound = true;
                                cvRecord = mapOfContentVersion[key];
                            }
                        }
                        //For Deferral Document
                        var isDefRecordFound = false;
                        var defRecord;
                        for (var key in mapOfDeferralDocument) {
                            if (key === uniqueKey && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                                isDefRecordFound = true;
                                defRecord = mapOfDeferralDocument[key];
                                console.log('DEFERED RECORD FOUND', defRecord.Document_Name__c);
                            }
                        }
                        listOfEmpoymentDetails.forEach(emp => {
                            if (emp.Loan_Applicant__c === loan.Id) {
                                loanApplicantIds.push(loan.Id);
                                var newRowDocumentRecord = {
                                    'documentCode': element.Document_Master__r.Name,
                                    'docSetCodeId': element.Id,
                                    'serialNumber': '',
                                    'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                                    'documentName': element.Name,
                                    'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                                    'documentFamily': element.Family__c,
                                    'applicableFor': element.Applicable_For__c,
                                    'applicableName': loan.Customer_Information__r.Name,
                                    'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                                    'mandatory': emp.Occupation__c === element.Income_Type__c ? 'Yes' : 'No',
                                    'documentType': element.Type__c,
                                    'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                                    'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                                    'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                                    'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                                    'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                                    'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                                    'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                                    'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                                    'original': isCVRecordFound ? cvRecord.Original__c : '',
                                    'deferredStageDisable': true,
                                    'deferredRequired': false,
                                    'isReceivedDateRequired': false,
                                    'receivedDateDisable': true,
                                    'isWaiverRequired': false,
                                    'waiverReasonDisable': true,
                                    'isNewRowAdded': false,
                                    'isDocumentMaster': false,
                                    'fileName': '',
                                    'isFileUploadDisabled': true,
                                    'isFileUploadRequired': true,
                                    'isoriginalDisabled': true,
                                    'fileData': '',
                                    'isAgreementExecution': isAgreementExecution,
                                    'applicantId': loan.Customer_Information__c,
                                    'customerType': loan.Customer_Type__c,
                                    'customerName': loan.Applicant_Name__c,
                                    'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                                    'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                                    'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                                }
                                if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                                    newRowDocumentRecord.status = cvRecord.Status__c;
                                    // newRowDocumentRecord.isFileUploadDisabled = false;
                                    // newRowDocumentRecord.isFileUploadRequired = false;
                                }
                                applicantJSON.push(newRowDocumentRecord);
                            }
                        })
                        if (!loanApplicantIds.includes(loan.Id)) {
                            var newRowDocumentRecord = {
                                'documentCode': element.Document_Master__r.Name,
                                'docSetCodeId': element.Id,
                                'serialNumber': '',
                                'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                                'documentName': element.Name,
                                'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                                'documentFamily': element.Family__c,
                                'applicableFor': element.Applicable_For__c,
                                'applicableName': loan.Customer_Information__r.Name,
                                'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                                'mandatory': element.Mandatory__c,
                                'documentType': element.Type__c,
                                'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                                'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                                'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                                'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                                'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                                'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                                'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                                'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                                'original': isCVRecordFound ? cvRecord.Original__c : '',
                                'deferredStageDisable': true,
                                'deferredRequired': false,
                                'isReceivedDateRequired': false,
                                'receivedDateDisable': true,
                                'isWaiverRequired': false,
                                'waiverReasonDisable': true,
                                'isNewRowAdded': false,
                                'isDocumentMaster': false,
                                'fileName': '',
                                'isFileUploadDisabled': true,
                                'isFileUploadRequired': true,
                                'isoriginalDisabled': true,
                                'fileData': '',
                                'isAgreementExecution': isAgreementExecution,
                                'applicantId': loan.Customer_Information__c,
                                'customerType': loan.Customer_Type__c,
                                'customerName': loan.Applicant_Name__c,
                                'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                                'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                                'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                            }
                            if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                                newRowDocumentRecord.status = cvRecord.Status__c;
                                // newRowDocumentRecord.isFileUploadDisabled = false;
                                // newRowDocumentRecord.isFileUploadRequired = false;
                            }
                            applicantJSON.push(newRowDocumentRecord);
                        }
                    })
                }
                else if (element.Applicable_For__c !== "All" && element.Income_Type__c === "All" && listOfEmpoymentDetails.length) {
                    console.log('** Inside six case **');
                    var loanApplicantIds = [];
                    listOfLoanApplicant.forEach(loan => {
                        if (loan.Customer_Type__c === element.Applicable_For__c) {
                            var isCVRecordFound = false;
                            var cvRecord;
                            var uniqueKey = element.Id + '-' + loan.Customer_Information__c;
                            for (var key in mapOfContentVersion) {
                                if (key === uniqueKey && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                                    isCVRecordFound = true;
                                    cvRecord = mapOfContentVersion[key];
                                }
                            }
                            //For Deferral Document
                            var isDefRecordFound = false;
                            var defRecord;
                            for (var key in mapOfDeferralDocument) {
                                if (key === uniqueKey && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                                    isDefRecordFound = true;
                                    defRecord = mapOfDeferralDocument[key];
                                    console.log('DEFERED RECORD FOUND', defRecord.Document_Name__c);
                                }
                            }
                            listOfEmpoymentDetails.forEach(emp => {
                                if (emp.Loan_Applicant__c === loan.Id) {
                                    loanApplicantIds.push(loan.Id);
                                    var newRowDocumentRecord = {
                                        'documentCode': element.Document_Master__r.Name,
                                        'docSetCodeId': element.Id,
                                        'serialNumber': '',
                                        'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                                        'documentName': element.Name,
                                        'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                                        'documentFamily': element.Family__c,
                                        'applicableFor': element.Applicable_For__c,
                                        'applicableName': loan.Customer_Information__r.Name,
                                        'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                                        'mandatory': loan.Customer_Type__c === element.Applicable_For__c ? 'Yes' : 'No',
                                        'documentType': element.Type__c,
                                        'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                                        'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                                        'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                                        'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                                        'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                                        'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                                        'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                                        'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                                        'original': isCVRecordFound ? cvRecord.Original__c : '',
                                        'deferredStageDisable': true,
                                        'deferredRequired': false,
                                        'isReceivedDateRequired': false,
                                        'receivedDateDisable': true,
                                        'isWaiverRequired': false,
                                        'waiverReasonDisable': true,
                                        'isNewRowAdded': false,
                                        'isDocumentMaster': false,
                                        'fileName': '',
                                        'isFileUploadDisabled': true,
                                        'isFileUploadRequired': true,
                                        'isoriginalDisabled': true,
                                        'fileData': '',
                                        'isAgreementExecution': isAgreementExecution,
                                        'applicantId': loan.Customer_Information__c,
                                        'customerType': loan.Customer_Type__c,
                                        'customerName': loan.Applicant_Name__c,
                                        'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                                        'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                                        'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                                    }
                                    if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                                        newRowDocumentRecord.status = cvRecord.Status__c;
                                        // newRowDocumentRecord.isFileUploadDisabled = false;
                                        // newRowDocumentRecord.isFileUploadRequired = false;
                                    }
                                    applicantJSON.push(newRowDocumentRecord);
                                }
                            })
                            if (!loanApplicantIds.includes(loan.Id)) {
                                var newRowDocumentRecord = {
                                    'documentCode': element.Document_Master__r.Name,
                                    'docSetCodeId': element.Id,
                                    'serialNumber': '',
                                    'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                                    'documentName': element.Name,
                                    'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                                    'documentFamily': element.Family__c,
                                    'applicableFor': element.Applicable_For__c,
                                    'applicableName': loan.Customer_Information__r.Name,
                                    'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                                    'mandatory': element.Mandatory__c,
                                    'documentType': element.Type__c,
                                    'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                                    'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                                    'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                                    'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                                    'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                                    'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                                    'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                                    'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                                    'original': isCVRecordFound ? cvRecord.Original__c : '',
                                    'deferredStageDisable': true,
                                    'deferredRequired': false,
                                    'isReceivedDateRequired': false,
                                    'receivedDateDisable': true,
                                    'isWaiverRequired': false,
                                    'waiverReasonDisable': true,
                                    'isNewRowAdded': false,
                                    'isDocumentMaster': false,
                                    'fileName': '',
                                    'isFileUploadDisabled': true,
                                    'isFileUploadRequired': true,
                                    'isoriginalDisabled': true,
                                    'fileData': '',
                                    'isAgreementExecution': isAgreementExecution,
                                    'applicantId': loan.Customer_Information__c,
                                    'customerType': loan.Customer_Type__c,
                                    'customerName': loan.Applicant_Name__c,
                                    'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                                    'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                                    'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                                }
                                if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                                    newRowDocumentRecord.status = cvRecord.Status__c;
                                    // newRowDocumentRecord.isFileUploadDisabled = false;
                                    // newRowDocumentRecord.isFileUploadRequired = false;
                                }
                                applicantJSON.push(newRowDocumentRecord);
                            }
                        }
                    })
                }
                else if (element.Applicable_For__c !== "All" && element.Income_Type__c !== "All" && listOfEmpoymentDetails.length) {
                    console.log('** Inside seven case **');
                    var loanApplicantIds = [];
                    listOfLoanApplicant.forEach(loan => {

                        var isCVRecordFound = false;
                        var cvRecord;
                        var uniqueKey = element.Id + '-' + loan.Customer_Information__c;
                        for (var key in mapOfContentVersion) {
                            if (key === uniqueKey && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                                isCVRecordFound = true;
                                cvRecord = mapOfContentVersion[key];
                            }
                        }
                        //For Deferral Document
                        var isDefRecordFound = false;
                        var defRecord;
                        for (var key in mapOfDeferralDocument) {
                            if (key === uniqueKey && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                                isDefRecordFound = true;
                                defRecord = mapOfDeferralDocument[key];
                                console.log('DEFERED RECORD FOUND', defRecord.Document_Name__c);
                            }
                        }
                        listOfEmpoymentDetails.forEach(emp => {
                            if (emp.Loan_Applicant__c === loan.Id) {
                                loanApplicantIds.push(loan.Id);
                                var newRowDocumentRecord = {
                                    'documentCode': element.Document_Master__r.Name,
                                    'docSetCodeId': element.Id,
                                    'serialNumber': '',
                                    'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                                    'documentName': element.Name,
                                    'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                                    'documentFamily': element.Family__c,
                                    'applicableFor': element.Applicable_For__c,
                                    'applicableName': loan.Customer_Information__r.Name,
                                    'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                                    'mandatory': emp.Occupation__c === element.Income_Type__c && loan.Customer_Type__c === element.Applicable_For__c ? 'Yes' : 'No',
                                    'documentType': element.Type__c,
                                    'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                                    'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                                    'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                                    'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                                    'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                                    'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                                    'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                                    'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                                    'original': isCVRecordFound ? cvRecord.Original__c : '',
                                    'deferredStageDisable': true,
                                    'deferredRequired': false,
                                    'isReceivedDateRequired': false,
                                    'receivedDateDisable': true,
                                    'isWaiverRequired': false,
                                    'waiverReasonDisable': true,
                                    'isNewRowAdded': false,
                                    'isDocumentMaster': false,
                                    'fileName': '',
                                    'isFileUploadDisabled': true,
                                    'isFileUploadRequired': true,
                                    'isoriginalDisabled': true,
                                    'fileData': '',
                                    'isAgreementExecution': isAgreementExecution,
                                    'applicantId': loan.Customer_Information__c,
                                    'customerType': loan.Customer_Type__c,
                                    'customerName': loan.Applicant_Name__c,
                                    'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                                    'deferalRecordId': !isCVRecordFound && isDefRecordFound ? defRecord.Id : '',
                                    'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                                }
                                if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                                    newRowDocumentRecord.status = cvRecord.Status__c;
                                    // newRowDocumentRecord.isFileUploadDisabled = false;
                                    // newRowDocumentRecord.isFileUploadRequired = false;
                                }
                                applicantJSON.push(newRowDocumentRecord);
                            }
                        });
                        if (!loanApplicantIds.includes(loan.Id)) {
                            var newRowDocumentRecord = {
                                'documentCode': element.Document_Master__r.Name,
                                'docSetCodeId': element.Id,
                                'serialNumber': '',
                                'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                                'documentName': element.Name,
                                'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                                'documentFamily': element.Family__c,
                                'applicableFor': element.Applicable_For__c,
                                'applicableName': loan.Customer_Information__r.Name,
                                'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                                'mandatory': element.Mandatory__c,
                                'documentType': element.Type__c,
                                'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                                'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                                'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                                'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                                'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                                'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                                'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                                'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                                'original': isCVRecordFound ? cvRecord.Original__c : '',
                                'deferredStageDisable': true,
                                'deferredRequired': false,
                                'isReceivedDateRequired': false,
                                'receivedDateDisable': true,
                                'isWaiverRequired': false,
                                'waiverReasonDisable': true,
                                'isNewRowAdded': false,
                                'isDocumentMaster': false,
                                'fileName': '',
                                'isFileUploadDisabled': true,
                                'isFileUploadRequired': true,
                                'isoriginalDisabled': true,
                                'fileData': '',
                                'isAgreementExecution': isAgreementExecution,
                                'applicantId': loan.Customer_Information__c,
                                'customerType': loan.Customer_Type__c,
                                'customerName': loan.Applicant_Name__c,
                                'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? defRecord.Is_Deferral_Document__c : false,
                                'deferalRecordId': isDefRecordFound ? defRecord.Id : '',
                                'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                            }
                            if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                                newRowDocumentRecord.status = cvRecord.Status__c;
                                // newRowDocumentRecord.isFileUploadDisabled = false;
                                // newRowDocumentRecord.isFileUploadRequired = false;
                            }
                            applicantJSON.push(newRowDocumentRecord);
                        }
                    });
                }
            }
        }
        /**
         * Set Asset JSON
         */
        if (element.Type__c === 'Asset') {
            listOfProperty.forEach(property => {
                var isCVRecordFound = false;
                var cvRecord;
                var setCodeWithPropertyId = element.Id + property.Id;
                var setCodeWithParentPropertyId = element.Id;
                if (stageName === 'Login') {
                    setCodeWithParentPropertyId += property.Id;
                } else {
                    setCodeWithParentPropertyId += property.Property__c
                }
                for (var key in mapOfContentVersion) {
                    var splitedCVIds = key.split('-');
                    if ((splitedCVIds[0] === setCodeWithPropertyId || splitedCVIds[1] === setCodeWithParentPropertyId || (mapOfContentVersion[key].Uploaded_From__c === 'Login' && splitedCVIds[0] === element.Id + property.Property__c)) && element.Type__c === mapOfContentVersion[key].Document_Type__c) {
                        isCVRecordFound = true;
                        cvRecord = mapOfContentVersion[key];
                    }
                }
                //For Deferral Document
                var isDefRecordFound = false;
                var defRecord;
                for (var key in mapOfDeferralDocument) {
                    var splitedDefIds = key.split('-');
                    if ((splitedDefIds[0] === setCodeWithPropertyId || splitedDefIds[1] === setCodeWithParentPropertyId || (mapOfDeferralDocument[key].Deferred_From__c === 'Login' && splitedDefIds[0] === element.Id + property.Property__c)) && element.Type__c === mapOfDeferralDocument[key].Type__c) {
                        isDefRecordFound = true;
                        defRecord = mapOfDeferralDocument[key];
                        console.log('DEFERED RECORD FOUND', defRecord.Document_Name__c);
                    }
                }
                if (element.Asset_Type__c === 'All') {
                    console.log('inside asset case 1');
                    var newRowDocumentRecord = {
                        'documentCode': element.Document_Master__r.Name,
                        'docSetCodeId': element.Id,
                        'serialNumber': '',
                        'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                        'applicableFor': element.Asset_Type__c,
                        'applicableName': property.Name,
                        'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                        'documentName': element.Name,
                        'documentFamily': element.Family__c,
                        'documentType': element.Type__c,
                        'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                        'mandatory': element.Mandatory__c,
                        'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                        'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                        'stage': isDefRecordFound && (defRecord.Status__c === 'Deferred' || defRecord.Status__c === 'Waived') ? defRecord.Deferral_Stage__c : '',
                        'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                        'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                        'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                        'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                        'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                        'original': isCVRecordFound ? cvRecord.Original__c : '',
                        'deferredStageDisable': true,
                        'deferredRequired': false,
                        'isReceivedDateRequired': false,
                        'receivedDateDisable': true,
                        'isWaiverRequired': false,
                        'waiverReasonDisable': true,
                        'isNewRowAdded': false,
                        'isDocumentMaster': false,
                        'fileName': '',
                        'isFileUploadDisabled': true,
                        'isFileUploadRequired': true,
                        'isoriginalDisabled': true,
                        'fileData': '',
                        'isAgreementExecution': isAgreementExecution,
                        'propertyId': property.Id,
                        'propertyName': property.Name,
                        'propertyType': property.Property_Type__c,
                        'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? element.Is_Deferral_Document__c : false,
                        'deferalRecordId': isDefRecordFound ? element.Id : '',
                        'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                    }
                    if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                        newRowDocumentRecord.status = cvRecord.Status__c;
                        // newRowDocumentRecord.isFileUploadDisabled = false;
                        // newRowDocumentRecord.isFileUploadRequired = false;
                    }
                    propertyJSON.push(newRowDocumentRecord);
                } else if (element.Asset_Type__c !== 'All' && element.Asset_Type__c === property.Property_Type__c) {
                    console.log('inside asset case 2');
                    var newRowDocumentRecord = {
                        'documentCode': element.Document_Master__r.Name,
                        'docSetCodeId': element.Id,
                        'serialNumber': '',
                        'deferredFrom' :  isDefRecordFound ? defRecord.Deferred_From__c : '',
                        'applicableFor': element.Asset_Type__c,
                        'applicableName': property.Name,
                        'versionNumber': isCVRecordFound ? cvRecord.Version_Number__c : '',
                        'documentName': element.Name,
                        'documentFamily': element.Family__c,
                        'docReceivedStage': isDefRecordFound && !isCVRecordFound ? defRecord.Deferral_Stage__c : element.Stage__c,
                        'mandatory': element.Asset_Type__c === property.Property_Type__c ? 'Yes' : 'No',
                        'documentType': element.Type__c,
                        'status': isCVRecordFound ? cvRecord.Status__c : isDefRecordFound && defRecord.Status__c === 'Deferred' ? 'Deferred' : isDefRecordFound && defRecord.Deferred_From__c === defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : isDefRecordFound && defRecord.Deferred_From__c !== defRecord.Uploaded_From__c && defRecord.Status__c === 'Waived' ? 'Waived' : 'Not Received',
                        'isStatusDisabled': isCVRecordFound ? true : isDefRecordFound && defRecord && element.Stage__c === stageName ? true : isDefRecordFound && defRecord && defRecord.Is_Document_Received__c ? true : isDefRecordFound && defRecord && defRecord.Status__c === 'Waived' ? true : false,
                        'stage': isDefRecordFound && defRecord.Status__c === 'Deferred' ? defRecord.Deferral_Stage__c : '',
                        'deferredDate': isDefRecordFound && defRecord ? defRecord.Deferral_Date__c : '',
                        'receivedDate': isCVRecordFound ? cvRecord.Received_Date__c : '',
                        'noOfPages': isCVRecordFound ? cvRecord.Number_of_Pages__c : '',
                        'waiverReason': isDefRecordFound && defRecord.Status__c === 'Waived' ? defRecord.Waiver_Reason__c : '',
                        'remarks': isCVRecordFound ? cvRecord.Remarks__c : isDefRecordFound ? defRecord.Remarks__c : '',
                        'original': isCVRecordFound ? cvRecord.Original__c : '',
                        'deferredStageDisable': true,
                        'deferredRequired': false,
                        'isReceivedDateRequired': false,
                        'receivedDateDisable': true,
                        'isWaiverRequired': false,
                        'waiverReasonDisable': true,
                        'isNewRowAdded': false,
                        'isDocumentMaster': false,
                        'fileName': '',
                        'isFileUploadDisabled': true,
                        'isFileUploadRequired': true,
                        'isoriginalDisabled': true,
                        'fileData': '',
                        'isAgreementExecution': isAgreementExecution,
                        'propertyId': property.Id,
                        'propertyName': property.Name,
                        'propertyType': property.Property_Type__c,
                        'isDeferalRecord': !isCVRecordFound && isDefRecordFound ? element.Is_Deferral_Document__c : false,
                        'deferalRecordId': isDefRecordFound ? element.Id : '',
                        'contentDocumentId': isCVRecordFound ? cvRecord.ContentDocumentId : '',
                    }
                    if (isCVRecordFound && cvRecord.Status__c === 'Waived') {
                        newRowDocumentRecord.status = cvRecord.Status__c;
                        // newRowDocumentRecord.isFileUploadDisabled = false;
                        // newRowDocumentRecord.isFileUploadRequired = false;
                    }
                    propertyJSON.push(newRowDocumentRecord);
                }
            })
        }
    });

    dataObject.applicantJSON = JSON.parse(JSON.stringify(applicantJSON));
    dataObject.applicationJSON = JSON.parse(JSON.stringify(applicationJSON));
    dataObject.propertyJSON = JSON.parse(JSON.stringify(propertyJSON));
    dataObject.documentMasterIds = JSON.parse(JSON.stringify(documentMasterIds));

    console.log('dataObject ', JSON.stringify(dataObject));

    return dataObject;
}